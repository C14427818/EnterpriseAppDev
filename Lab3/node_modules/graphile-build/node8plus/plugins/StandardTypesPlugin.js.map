{"version":3,"sources":["../../src/plugins/StandardTypesPlugin.js"],"names":["StandardTypesPlugin","builder","hook","build","stringType","name","description","graphql","GraphQLScalarType","serialize","value","String","parseValue","parseLiteral","ast","kind","STRING","Error","Cursor","addType","_","newWithHooks","GraphQLNonNull","GraphQLObjectType","GraphQLBoolean","fields","fieldWithHooks","hasNextPage","addDataGenerator","calculateHasNextPage","type","isPageInfoHasNextPageField","hasPreviousPage","calculateHasPreviousPage","isPageInfoHasPreviousPageField","isPageInfo"],"mappings":";;;;;;AAEA;;kBAEgB,SAASA,mBAAT,CAA6BC,OAA7B,EAAsC;AACpD;AACAA,UAAQC,IAAR,CAAa,OAAb,EAAuBC,KAAD,IAAyB;AAC7C,UAAMC,aAAa,CAACC,IAAD,EAAOC,WAAP,KACjB,IAAIH,MAAMI,OAAN,CAAcC,iBAAlB,CAAoC;AAClCH,UADkC;AAElCC,iBAFkC;AAGlCG,iBAAWC,SAASC,OAAOD,KAAP,CAHc;AAIlCE,kBAAYF,SAASC,OAAOD,KAAP,CAJa;AAKlCG,oBAAcC,OAAO;AACnB,YAAIA,IAAIC,IAAJ,KAAa,eAAKC,MAAtB,EAA8B;AAC5B,gBAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;AACD;AACD,eAAOH,IAAIJ,KAAX;AACD;AAViC,KAApC,CADF;;AAcA,UAAMQ,SAASd,WACb,QADa,EAEb,sEAFa,CAAf;AAIAD,UAAMgB,OAAN,CAAcD,MAAd;AACA,WAAOf,KAAP;AACD,GArBD;AAsBAF,UAAQC,IAAR,CACE,MADF,EAEE,CACEkB,CADF,EAEE;AACEC,gBADF;AAEEd,aAAS,EAAEe,cAAF,EAAkBC,iBAAlB,EAAqCC,cAArC;AAFX,GAFF,KAMK;AACH;AACA;AACAH,iBACEE,iBADF,EAEE;AACElB,YAAM,UADR;AAEEC,mBAAa,+CAFf;AAGEmB,cAAQ,CAAC,EAAEC,cAAF,EAAD,MAAyB;AAC/BC,qBAAaD,eACX,aADW,EAEX,CAAC,EAAEE,gBAAF,EAAD,KAA0B;AACxBA,2BAAiB,MAAM;AACrB,mBAAO;AACLC,oCAAsB;AADjB,aAAP;AAGD,WAJD;AAKA,iBAAO;AACLvB,yBACE,iDAFG;AAGLwB,kBAAM,IAAIR,cAAJ,CAAmBE,cAAnB;AAHD,WAAP;AAKD,SAbU,EAcX,EAAEO,4BAA4B,IAA9B,EAdW,CADkB;AAiB/BC,yBAAiBN,eACf,iBADe,EAEf,CAAC,EAAEE,gBAAF,EAAD,KAA0B;AACxBA,2BAAiB,MAAM;AACrB,mBAAO;AACLK,wCAA0B;AADrB,aAAP;AAGD,WAJD;AAKA,iBAAO;AACL3B,yBACE,kDAFG;AAGLwB,kBAAM,IAAIR,cAAJ,CAAmBE,cAAnB;AAHD,WAAP;AAKD,SAbc,EAcf,EAAEU,gCAAgC,IAAlC,EAde;AAjBc,OAAzB;AAHV,KAFF,EAwCE;AACEC,kBAAY;AADd,KAxCF;AA4CA,WAAOf,CAAP;AACD,GAxDH;AA0DD,C","file":"StandardTypesPlugin.js","sourcesContent":["// @flow\nimport type { Plugin, Build } from \"../SchemaBuilder\";\nimport { Kind } from \"graphql/language\";\n\nexport default (function StandardTypesPlugin(builder) {\n  // XXX: this should be in an \"init\" plugin, but PgTypesPlugin requires it in build - fix that, then fix this\n  builder.hook(\"build\", (build: Build): Build => {\n    const stringType = (name, description) =>\n      new build.graphql.GraphQLScalarType({\n        name,\n        description,\n        serialize: value => String(value),\n        parseValue: value => String(value),\n        parseLiteral: ast => {\n          if (ast.kind !== Kind.STRING) {\n            throw new Error(\"Can only parse string values\");\n          }\n          return ast.value;\n        },\n      });\n\n    const Cursor = stringType(\n      \"Cursor\",\n      \"A location in a connection that can be used for resuming pagination.\"\n    );\n    build.addType(Cursor);\n    return build;\n  });\n  builder.hook(\n    \"init\",\n    (\n      _: {},\n      {\n        newWithHooks,\n        graphql: { GraphQLNonNull, GraphQLObjectType, GraphQLBoolean },\n      }\n    ) => {\n      // https://facebook.github.io/relay/graphql/connections.htm#sec-undefined.PageInfo\n      /* const PageInfo = */\n      newWithHooks(\n        GraphQLObjectType,\n        {\n          name: \"PageInfo\",\n          description: \"Information about pagination in a connection.\",\n          fields: ({ fieldWithHooks }) => ({\n            hasNextPage: fieldWithHooks(\n              \"hasNextPage\",\n              ({ addDataGenerator }) => {\n                addDataGenerator(() => {\n                  return {\n                    calculateHasNextPage: true,\n                  };\n                });\n                return {\n                  description:\n                    \"When paginating forwards, are there more items?\",\n                  type: new GraphQLNonNull(GraphQLBoolean),\n                };\n              },\n              { isPageInfoHasNextPageField: true }\n            ),\n            hasPreviousPage: fieldWithHooks(\n              \"hasPreviousPage\",\n              ({ addDataGenerator }) => {\n                addDataGenerator(() => {\n                  return {\n                    calculateHasPreviousPage: true,\n                  };\n                });\n                return {\n                  description:\n                    \"When paginating backwards, are there more items?\",\n                  type: new GraphQLNonNull(GraphQLBoolean),\n                };\n              },\n              { isPageInfoHasPreviousPageField: true }\n            ),\n          }),\n        },\n        {\n          isPageInfo: true,\n        }\n      );\n      return _;\n    }\n  );\n}: Plugin);\n"]}