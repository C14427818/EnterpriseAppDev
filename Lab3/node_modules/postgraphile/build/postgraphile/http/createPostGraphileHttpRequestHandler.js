"use strict";
const path_1 = require("path");
const fs_1 = require("fs");
const graphql_1 = require("graphql");
const extendedFormatError_1 = require("../extendedFormatError");
const setupServerSentEvents_1 = require("./setupServerSentEvents");
const withPostGraphileContext_1 = require("../withPostGraphileContext");
const chalk = require('chalk');
const Debugger = require('debug'); // tslint:disable-line variable-name
const httpError = require('http-errors');
const parseUrl = require('parseurl');
const finalHandler = require('finalhandler');
const bodyParser = require('body-parser');
const sendFile = require('send');
const { POSTGRAPHILE_ENV } = process.env;
const debugGraphql = new Debugger('postgraphile:graphql');
const debugRequest = new Debugger('postgraphile:request');
exports.graphiqlDirectory = path_1.resolve(__dirname, '../graphiql/public');
/**
 * The favicon file in `Buffer` format. We can send a `Buffer` directly to the
 * client.
 *
 * @type {Promise<Buffer>}
 */
const favicon = new Promise((resolve, reject) => {
    fs_1.readFile(path_1.resolve(__dirname, '../../../resources/favicon.ico'), (error, data) => {
        if (error)
            reject(error);
        else
            resolve(data);
    });
});
/**
 * The GraphiQL HTML file as a string. We need it to be a string, because we
 * will use a regular expression to replace some variables.
 *
 * @type {Promise<string>}
 */
const origGraphiqlHtml = new Promise((resolve, reject) => {
    fs_1.readFile(path_1.resolve(__dirname, '../graphiql/public/index.html'), 'utf8', (error, data) => {
        if (error)
            reject(error);
        else
            resolve(data);
    });
});
/**
 * Creates a GraphQL request handler, this is untyped besides some JSDoc types
 * for intellisense.
 *
 * @param {GraphQLSchema} graphqlSchema
 */
function createPostGraphileHttpRequestHandler(options) {
    const { getGqlSchema, pgPool, pgSettings, pgDefaultRole, jwtSecret, jwtAudiences, jwtRole, jwtVerifyOptions, additionalGraphQLContextFromRequest, } = options;
    if (pgDefaultRole && typeof pgSettings === 'function') {
        throw new Error('pgDefaultRole cannot be combined with pgSettings(req) - please remove pgDefaultRole and instead always return a `role` key from pgSettings(req).');
    }
    if (pgDefaultRole &&
        pgSettings &&
        typeof pgSettings === 'object' &&
        Object.keys(pgSettings)
            .map(s => s.toLowerCase())
            .indexOf('role') >= 0) {
        throw new Error('pgDefaultRole cannot be combined with pgSettings.role - please use one or the other.');
    }
    // Gets the route names for our GraphQL endpoint, and our GraphiQL endpoint.
    const graphqlRoute = options.graphqlRoute || '/graphql';
    const graphiqlRoute = options.graphiql === true ? options.graphiqlRoute || '/graphiql' : null;
    // Throw an error of the GraphQL and GraphiQL routes are the same.
    if (graphqlRoute === graphiqlRoute)
        throw new Error(`Cannot use the same route, '${graphqlRoute}', for both GraphQL and GraphiQL. Please use different routes.`);
    // Formats an error using the default GraphQL `formatError` function, and
    // custom formatting using some other options.
    const formatError = error => {
        // Get the appropriate formatted error object, including any extended error
        // fields if the user wants them.
        const formattedError = options.extendedErrors && options.extendedErrors.length
            ? extendedFormatError_1.extendedFormatError(error, options.extendedErrors)
            : graphql_1.formatError(error);
        // If the user wants to see the error’s stack, let’s add it to the
        // formatted error.
        if (options.showErrorStack)
            formattedError.stack =
                options.showErrorStack === 'json'
                    ? error.stack.split('\n')
                    : error.stack;
        return formattedError;
    };
    // Define a list of middlewares that will get run before our request handler.
    // Note though that none of these middlewares will intercept a request (i.e.
    // not call `next`). Middlewares that handle a request like favicon
    // middleware will result in a promise that never resolves, and we don’t
    // want that.
    const bodyParserMiddlewares = [
        // Parse JSON bodies.
        bodyParser.json({ limit: options.bodySizeLimit }),
        // Parse URL encoded bodies (forms).
        bodyParser.urlencoded({ extended: false }),
        // Parse `application/graphql` content type bodies as text.
        bodyParser.text({ type: 'application/graphql' }),
    ];
    // Takes the original GraphiQL HTML file and replaces the default config object.
    const graphiqlHtml = origGraphiqlHtml.then(html => html.replace(/window\.POSTGRAPHILE_CONFIG\s*=\s*\{[^]*\}/, `window.POSTGRAPHILE_CONFIG={graphqlUrl:'${graphqlRoute}',streamUrl:${options.watchPg ? '\'/_postgraphile/stream\'' : 'null'}}`));
    /**
     * The actual request handler. It’s an async function so it will return a
     * promise when complete. If the function doesn’t handle anything, it calls
     * `next` to let the next middleware try and handle it.
     *
     * @param {IncomingMessage} req
     * @param {ServerResponse} res
     */
    const requestHandler = async (req, res, next) => {
        // Add our CORS headers to be good web citizens (there are perf
        // implications though so be careful!)
        //
        // Always enable CORS when developing PostGraphile because GraphiQL will be
        // on port 5783.
        if (options.enableCors || POSTGRAPHILE_ENV === 'development')
            addCORSHeaders(res);
        // ========================================================================
        // Serve GraphiQL and Related Assets
        // ========================================================================
        if (options.graphiql) {
            // ======================================================================
            // Favicon
            // ======================================================================
            // If this is the favicon path and it has not yet been handled, let us
            // serve our GraphQL favicon.
            if (parseUrl(req).pathname === '/favicon.ico') {
                // If this is the wrong method, we should let the client know.
                if (!(req.method === 'GET' || req.method === 'HEAD')) {
                    res.statusCode = req.method === 'OPTIONS' ? 200 : 405;
                    res.setHeader('Allow', 'GET, HEAD, OPTIONS');
                    res.end();
                    return;
                }
                // Otherwise we are good and should pipe the favicon to the browser.
                res.statusCode = 200;
                res.setHeader('Cache-Control', 'public, max-age=86400');
                res.setHeader('Content-Type', 'image/x-icon');
                // End early if the method is `HEAD`.
                if (req.method === 'HEAD') {
                    res.end();
                    return;
                }
                res.end(await favicon);
                return;
            }
            // ======================================================================
            // GraphiQL `create-react-app` Assets
            // ======================================================================
            // Serve the assets for GraphiQL on a namespaced path. This will basically
            // serve up the built GraphiQL directory.
            if (parseUrl(req).pathname.startsWith('/_postgraphile/graphiql/')) {
                // If using the incorrect method, let the user know.
                if (!(req.method === 'GET' || req.method === 'HEAD')) {
                    res.statusCode = req.method === 'OPTIONS' ? 200 : 405;
                    res.setHeader('Allow', 'GET, HEAD, OPTIONS');
                    res.end();
                    return;
                }
                // Gets the asset path (the path name with the PostGraphile prefix
                // stripped off) and turns it into a real filesystem path
                const assetPath = path_1.resolve(path_1.join(exports.graphiqlDirectory, parseUrl(req).pathname.slice('/_postgraphile/graphiql/'.length)));
                // Figures out the relative path for assetPath within graphiqlDirectory
                // so we can correctly filter 'index.html' and 'asset-manifest.json'
                const assetPathRelative = path_1.relative(exports.graphiqlDirectory, assetPath);
                // Block any attempts at path traversal issues
                if (assetPath.substr(0, exports.graphiqlDirectory.length) !== exports.graphiqlDirectory ||
                    assetPathRelative.substr(0, 2) === '..') {
                    res.statusCode = 403;
                    res.end();
                    return;
                }
                // Don’t allow certain files generated by `create-react-app` to be
                // inspected.
                if (assetPathRelative === 'index.html' ||
                    assetPathRelative === 'asset-manifest.json') {
                    res.statusCode = 404;
                    res.end();
                    return;
                }
                // Sends the asset at this path. Defaults to a `statusCode` of 200.
                res.statusCode = 200;
                await new Promise((resolve, reject) => {
                    const stream = sendFile(req, assetPathRelative, {
                        index: false,
                        root: exports.graphiqlDirectory,
                        dotfiles: 'ignore',
                    })
                        .on('end', resolve)
                        .on('error', reject)
                        .pipe(res);
                });
                return;
            }
            // ======================================================================
            // GraphiQL Watch Stream
            // ======================================================================
            // Setup an event stream so we can broadcast events to graphiql, etc.
            if (parseUrl(req).pathname === '/_postgraphile/stream') {
                if (req.headers.accept !== 'text/event-stream') {
                    res.statusCode = 405;
                    res.end();
                    return;
                }
                setupServerSentEvents_1.default(req, res, options);
                return;
            }
            // ======================================================================
            // GraphiQL HTML
            // ======================================================================
            // If this is the GraphiQL route, show GraphiQL and stop execution.
            if (parseUrl(req).pathname === graphiqlRoute) {
                // If we are developing PostGraphile, instead just redirect.
                if (POSTGRAPHILE_ENV === 'development') {
                    res.writeHead(302, { Location: 'http://localhost:5783' });
                    res.end();
                    return;
                }
                // If using the incorrect method, let the user know.
                if (!(req.method === 'GET' || req.method === 'HEAD')) {
                    res.statusCode = req.method === 'OPTIONS' ? 200 : 405;
                    res.setHeader('Allow', 'GET, HEAD, OPTIONS');
                    res.end();
                    return;
                }
                res.statusCode = 200;
                res.setHeader('Content-Type', 'text/html; charset=utf-8');
                // End early if the method is `HEAD`.
                if (req.method === 'HEAD') {
                    res.end();
                    return;
                }
                // Actually renders GraphiQL.
                res.end(await graphiqlHtml);
                return;
            }
        }
        // Don’t handle any requests if this is not the correct route.
        if (parseUrl(req).pathname !== graphqlRoute)
            return next();
        // ========================================================================
        // Execute GraphQL Queries
        // ========================================================================
        // If we didn’t call `next` above, all requests will return 200 by default!
        res.statusCode = 200;
        // Don’t execute our GraphQL stuffs for `OPTIONS` requests.
        if (req.method === 'OPTIONS') {
            res.statusCode = 200;
            res.end();
            return;
        }
        // The `result` will be used at the very end in our `finally` block.
        // Statements inside the `try` will assign to `result` when they get
        // a result. We also keep track of `params`.
        let params;
        let result;
        let queryDocumentAst;
        const queryTimeStart = process.hrtime();
        let pgRole;
        debugRequest('GraphQL query request has begun.');
        // This big `try`/`catch`/`finally` block represents the execution of our
        // GraphQL query. All errors thrown in this block will be returned to the
        // client as GraphQL errors.
        try {
            // First thing we need to do is get the GraphQL schema for this request.
            // It should never really change unless we are in watch mode.
            const gqlSchema = await getGqlSchema();
            // Run all of our middleware by converting them into promises and
            // chaining them together. Remember that if we have a middleware that
            // never calls `next`, we will have a promise that never resolves! Avoid
            // those middlewares.
            //
            // Note that we also run our middleware after we make sure we are on the
            // correct route. This is so that if our middleware modifies the `req` or
            // `res` objects, only we downstream will see the modifications.
            //
            // We also run our middleware inside the `try` so that we get the GraphQL
            // error reporting style for syntax errors.
            await bodyParserMiddlewares.reduce((promise, middleware) => promise.then(() => new Promise((resolve, reject) => {
                middleware(req, res, error => {
                    if (error)
                        reject(error);
                    else
                        resolve();
                });
            })), Promise.resolve());
            // If this is not one of the correct methods, throw an error.
            if (req.method !== 'POST') {
                res.setHeader('Allow', 'POST, OPTIONS');
                throw httpError(405, 'Only `POST` requests are allowed.');
            }
            // Get the parameters we will use to run a GraphQL request. `params` may
            // include:
            //
            // - `query`: The required GraphQL query string.
            // - `variables`: An optional JSON object containing GraphQL variables.
            // - `operationName`: The optional name of the GraphQL operation we will
            //   be executing.
            params = typeof req.body === 'string' ? { query: req.body } : req.body;
            // Validate our params object a bit.
            if (params == null)
                throw httpError(400, 'Must provide an object parameters, not nullish value.');
            if (typeof params !== 'object')
                throw httpError(400, `Expected parameter object, not value of type '${typeof params}'.`);
            if (Array.isArray(params))
                throw httpError(501, 'Batching queries as an array is currently unsupported. Please provide a single query object.');
            if (!params.query)
                throw httpError(400, 'Must provide a query string.');
            // If variables is a string, we assume it is a JSON string and that it
            // needs to be parsed.
            if (typeof params.variables === 'string') {
                // If variables is just an empty string, we should set it to null and
                // ignore it.
                if (params.variables === '') {
                    params.variables = null;
                }
                else {
                    // Otherwise, let us try to parse it as JSON.
                    try {
                        params.variables = JSON.parse(params.variables);
                    }
                    catch (error) {
                        error.statusCode = 400;
                        throw error;
                    }
                }
            }
            // Throw an error if `variables` is not an object.
            if (params.variables != null && typeof params.variables !== 'object')
                throw httpError(400, `Variables must be an object, not '${typeof params.variables}'.`);
            // Throw an error if `operationName` is not a string.
            if (params.operationName != null &&
                typeof params.operationName !== 'string')
                throw httpError(400, `Operation name must be a string, not '${typeof params.operationName}'.`);
            const source = new graphql_1.Source(params.query, 'GraphQL Http Request');
            // Catch an errors while parsing so that we can set the `statusCode` to
            // 400. Otherwise we don’t need to parse this way.
            try {
                queryDocumentAst = graphql_1.parse(source);
            }
            catch (error) {
                res.statusCode = 400;
                throw error;
            }
            debugRequest('GraphQL query is parsed.');
            // Validate our GraphQL query using given rules.
            // TODO: Add a complexity GraphQL rule.
            const validationErrors = graphql_1.validate(gqlSchema, queryDocumentAst);
            // If we have some validation errors, don’t execute the query. Instead
            // send the errors to the client with a `400` code.
            if (validationErrors.length > 0) {
                res.statusCode = 400;
                result = { errors: validationErrors };
                return;
            }
            debugRequest('GraphQL query is validated.');
            // Lazily log the query. If this debugger isn’t enabled, don’t run it.
            if (debugGraphql.enabled)
                debugGraphql(graphql_1.print(queryDocumentAst)
                    .replace(/\s+/g, ' ')
                    .trim());
            const jwtToken = options.jwtSecret ? getJwtToken(req) : null;
            const additionalContext = typeof additionalGraphQLContextFromRequest === 'function'
                ? await additionalGraphQLContextFromRequest(req, res)
                : {};
            result = await withPostGraphileContext_1.default({
                pgPool,
                jwtToken,
                jwtSecret,
                jwtAudiences,
                jwtRole,
                jwtVerifyOptions,
                pgDefaultRole,
                pgSettings: typeof pgSettings === 'function'
                    ? await pgSettings(req)
                    : pgSettings,
            }, context => {
                pgRole = context.pgRole;
                const graphqlContext = Object.assign({}, additionalContext, context);
                return graphql_1.execute(gqlSchema, queryDocumentAst, null, graphqlContext, params.variables, params.operationName);
            });
        }
        catch (error) {
            // Set our status code and send the client our results!
            if (res.statusCode === 200)
                res.statusCode = error.status || error.statusCode || 500;
            result = { errors: [error] };
            // If the status code is 500, let’s log our error.
            if (res.statusCode === 500)
                // tslint:disable-next-line no-console
                console.error(error.stack);
        }
        finally {
            // Finally, we send the client the contents of `result`.
            debugRequest('GraphQL query has been executed.');
            // Format our errors so the client doesn’t get the full thing.
            if (result && result.errors)
                result.errors = result.errors.map(formatError);
            res.setHeader('Content-Type', 'application/json; charset=utf-8');
            res.end(JSON.stringify(result));
            debugRequest('GraphQL query request finished.');
            // Log the query. If this debugger isn’t enabled, don’t run it.
            if (queryDocumentAst && !options.disableQueryLog) {
                const prettyQuery = graphql_1.print(queryDocumentAst)
                    .replace(/\s+/g, ' ')
                    .trim();
                const errorCount = (result.errors || []).length;
                const timeDiff = process.hrtime(queryTimeStart);
                const ms = Math.round((timeDiff[0] * 1e9 + timeDiff[1]) * 10e-7 * 100) / 100;
                // If we have enabled the query log for the Http handler, use that.
                // tslint:disable-next-line no-console
                console.log(`${chalk[errorCount === 0 ? 'green' : 'red'](`${errorCount} error(s)`)} ${pgRole != null ? `as ${chalk.magenta(pgRole)} ` : ''}in ${chalk.grey(`${ms}ms`)} :: ${prettyQuery}`);
            }
        }
    };
    /**
     * A polymorphic request handler that should detect what `http` framework is
     * being used and specifically handle that framework.
     *
     * Supported frameworks include:
     *
     * - Native Node.js `http`.
     * - `connect`.
     * - `express`.
     * - `koa` (2.0).
     */
    return (a, b, c) => {
        // If are arguments look like the arguments to koa middleware, this is
        // `koa` middleware.
        if (a.req && a.res && typeof b === 'function') {
            // Set the correct `koa` variable names…
            const ctx = a;
            const next = b;
            // Execute our request handler. If an error is thrown, we don’t call
            // `next` with an error. Instead we return the promise and let `koa`
            // handle the error.
            return requestHandler(ctx.req, ctx.res, next);
        }
        else {
            // Set the correct `connect` style variable names. If there was no `next`
            // defined (likely the case if the client is using `http`) we use the
            // final handler.
            const req = a;
            const res = b;
            const next = c || finalHandler(req, res);
            // Execute our request handler.
            requestHandler(req, res, next).then(
            // If the request was fulfilled, noop.
            () => {
                /* noop */
            }, 
            // If the request errored out, call `next` with the error.
            error => next(error));
        }
    };
}
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = createPostGraphileHttpRequestHandler;
/**
 * Adds CORS to a request. See [this][1] flowchart for an explanation of how
 * CORS works. Note that these headers are set for all requests, CORS
 * algorithms normally run a preflight request using the `OPTIONS` method to
 * get these headers.
 *
 * Note though, that enabling CORS will incur extra costs when it comes to the
 * preflight requests. It is much better if you choose to use a proxy and
 * bypass CORS altogether.
 *
 * [1]: http://www.html5rocks.com/static/images/cors_server_flowchart.png
 */
function addCORSHeaders(res) {
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Request-Method', 'HEAD, GET, POST');
    res.setHeader('Access-Control-Allow-Headers', [
        'Origin',
        'X-Requested-With',
        // Used by `express-graphql` to determine whether to expose the GraphiQL
        // interface (`text/html`) or not.
        'Accept',
        // Used by PostGraphile for auth purposes.
        'Authorization',
        // The `Content-*` headers are used when making requests with a body,
        // like in a POST request.
        'Content-Type',
        'Content-Length',
    ].join(', '));
}
/**
 * Parses the `Bearer` auth scheme token out of the `Authorization` header as
 * defined by [RFC7235][1].
 *
 * ```
 * Authorization = credentials
 * credentials   = auth-scheme [ 1*SP ( token68 / #auth-param ) ]
 * token68       = 1*( ALPHA / DIGIT / "-" / "." / "_" / "~" / "+" / "/" )*"="
 * ```
 *
 * [1]: https://tools.ietf.org/html/rfc7235
 *
 * @private
 */
const authorizationBearerRex = /^\s*bearer\s+([a-z0-9\-._~+/]+=*)\s*$/i;
/**
 * Gets the JWT token from the Http request’s headers. Specifically the
 * `Authorization` header in the `Bearer` format. Will throw an error if the
 * header is in the incorrect format, but will not throw an error if the header
 * does not exist.
 *
 * @private
 * @param {IncomingMessage} request
 * @returns {string | null}
 */
function getJwtToken(request) {
    const { authorization } = request.headers;
    // If there was no authorization header, just return null.
    if (authorization == null)
        return null;
    const match = authorizationBearerRex.exec(authorization);
    // If we did not match the authorization header with our expected format,
    // throw a 400 error.
    if (!match)
        throw httpError(400, 'Authorization header is not of the correct bearer scheme format.');
    // Return the token from our match.
    return match[1];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlUG9zdEdyYXBoaWxlSHR0cFJlcXVlc3RIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Bvc3RncmFwaGlsZS9odHRwL2NyZWF0ZVBvc3RHcmFwaGlsZUh0dHBSZXF1ZXN0SGFuZGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsK0JBSWE7QUFDYiwyQkFBNkI7QUFFN0IscUNBUWdCO0FBQ2hCLGdFQUE0RDtBQUk1RCxtRUFBMkQ7QUFFM0Qsd0VBQWdFO0FBRWhFLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUM5QixNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUEsQ0FBQyxvQ0FBb0M7QUFDdEUsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBQ3hDLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQTtBQUNwQyxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUE7QUFDNUMsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBQ3pDLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUVoQyxNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFBO0FBRXhDLE1BQU0sWUFBWSxHQUFHLElBQUksUUFBUSxDQUFDLHNCQUFzQixDQUFDLENBQUE7QUFDekQsTUFBTSxZQUFZLEdBQUcsSUFBSSxRQUFRLENBQUMsc0JBQXNCLENBQUMsQ0FBQTtBQUU1QyxRQUFBLGlCQUFpQixHQUFHLGNBQVcsQ0FBQyxTQUFTLEVBQUUsb0JBQW9CLENBQUMsQ0FBQTtBQUU3RTs7Ozs7R0FLRztBQUNILE1BQU0sT0FBTyxHQUFHLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU07SUFDMUMsYUFBUSxDQUNOLGNBQVcsQ0FBQyxTQUFTLEVBQUUsZ0NBQWdDLENBQUMsRUFDeEQsQ0FBQyxLQUFLLEVBQUUsSUFBSTtRQUNWLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQztZQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN4QixJQUFJO1lBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ3BCLENBQUMsQ0FDRixDQUFBO0FBQ0gsQ0FBQyxDQUFDLENBQUE7QUFFRjs7Ozs7R0FLRztBQUNILE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTTtJQUNuRCxhQUFRLENBQ04sY0FBVyxDQUFDLFNBQVMsRUFBRSwrQkFBK0IsQ0FBQyxFQUN2RCxNQUFNLEVBQ04sQ0FBQyxLQUFLLEVBQUUsSUFBSTtRQUNWLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQztZQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN4QixJQUFJO1lBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ3BCLENBQUMsQ0FDRixDQUFBO0FBQ0gsQ0FBQyxDQUFDLENBQUE7QUFFRjs7Ozs7R0FLRztBQUNILDhDQUE2RCxPQUFPO0lBQ2xFLE1BQU0sRUFDSixZQUFZLEVBQ1osTUFBTSxFQUNOLFVBQVUsRUFDVixhQUFhLEVBQ2IsU0FBUyxFQUNULFlBQVksRUFDWixPQUFPLEVBQ1AsZ0JBQWdCLEVBQ2hCLG1DQUFtQyxHQUNwQyxHQUFHLE9BQU8sQ0FBQTtJQUVYLEVBQUUsQ0FBQyxDQUFDLGFBQWEsSUFBSSxPQUFPLFVBQVUsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQ3RELE1BQU0sSUFBSSxLQUFLLENBQ2Isa0pBQWtKLENBQ25KLENBQUE7SUFDSCxDQUFDO0lBQ0QsRUFBRSxDQUFDLENBQ0QsYUFBYTtRQUNiLFVBQVU7UUFDVixPQUFPLFVBQVUsS0FBSyxRQUFRO1FBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO2FBQ3BCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO2FBQ3pCLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUN4QixDQUFDLENBQUMsQ0FBQztRQUNELE1BQU0sSUFBSSxLQUFLLENBQ2Isc0ZBQXNGLENBQ3ZGLENBQUE7SUFDSCxDQUFDO0lBRUQsNEVBQTRFO0lBQzVFLE1BQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQyxZQUFZLElBQUksVUFBVSxDQUFBO0lBQ3ZELE1BQU0sYUFBYSxHQUNqQixPQUFPLENBQUMsUUFBUSxLQUFLLElBQUksR0FBRyxPQUFPLENBQUMsYUFBYSxJQUFJLFdBQVcsR0FBRyxJQUFJLENBQUE7SUFFekUsa0VBQWtFO0lBQ2xFLEVBQUUsQ0FBQyxDQUFDLFlBQVksS0FBSyxhQUFhLENBQUM7UUFDakMsTUFBTSxJQUFJLEtBQUssQ0FDYiwrQkFBK0IsWUFBWSxnRUFBZ0UsQ0FDNUcsQ0FBQTtJQUVILHlFQUF5RTtJQUN6RSw4Q0FBOEM7SUFDOUMsTUFBTSxXQUFXLEdBQUcsS0FBSztRQUN2QiwyRUFBMkU7UUFDM0UsaUNBQWlDO1FBQ2pDLE1BQU0sY0FBYyxHQUNsQixPQUFPLENBQUMsY0FBYyxJQUFJLE9BQU8sQ0FBQyxjQUFjLENBQUMsTUFBTTtjQUNuRCx5Q0FBbUIsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLGNBQWMsQ0FBQztjQUNsRCxxQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUUvQixrRUFBa0U7UUFDbEUsbUJBQW1CO1FBQ25CLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUM7WUFDekIsY0FBYyxDQUFDLEtBQUs7Z0JBQ2xCLE9BQU8sQ0FBQyxjQUFjLEtBQUssTUFBTTtzQkFDN0IsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO3NCQUN2QixLQUFLLENBQUMsS0FBSyxDQUFBO1FBRW5CLE1BQU0sQ0FBQyxjQUFjLENBQUE7SUFDdkIsQ0FBQyxDQUFBO0lBRUQsNkVBQTZFO0lBQzdFLDRFQUE0RTtJQUM1RSxtRUFBbUU7SUFDbkUsd0VBQXdFO0lBQ3hFLGFBQWE7SUFDYixNQUFNLHFCQUFxQixHQUFHO1FBQzVCLHFCQUFxQjtRQUNyQixVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNqRCxvQ0FBb0M7UUFDcEMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsQ0FBQztRQUMxQywyREFBMkQ7UUFDM0QsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxxQkFBcUIsRUFBRSxDQUFDO0tBQ2pELENBQUE7SUFFRCxnRkFBZ0Y7SUFDaEYsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLElBQUksSUFDN0MsSUFBSSxDQUFDLE9BQU8sQ0FDViw0Q0FBNEMsRUFDNUMsMkNBQTJDLFlBQVksZUFDckQsT0FBTyxDQUFDLE9BQU8sR0FBRywyQkFBMkIsR0FBRyxNQUNsRCxHQUFHLENBQ0osQ0FDRixDQUFBO0lBRUQ7Ozs7Ozs7T0FPRztJQUNILE1BQU0sY0FBYyxHQUFHLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUk7UUFDMUMsK0RBQStEO1FBQy9ELHNDQUFzQztRQUN0QyxFQUFFO1FBQ0YsMkVBQTJFO1FBQzNFLGdCQUFnQjtRQUNoQixFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxJQUFJLGdCQUFnQixLQUFLLGFBQWEsQ0FBQztZQUMzRCxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUE7UUFFckIsMkVBQTJFO1FBQzNFLG9DQUFvQztRQUNwQywyRUFBMkU7UUFFM0UsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDckIseUVBQXlFO1lBQ3pFLFVBQVU7WUFDVix5RUFBeUU7WUFFekUsc0VBQXNFO1lBQ3RFLDZCQUE2QjtZQUM3QixFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxLQUFLLGNBQWMsQ0FBQyxDQUFDLENBQUM7Z0JBQzlDLDhEQUE4RDtnQkFDOUQsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEtBQUssS0FBSyxJQUFJLEdBQUcsQ0FBQyxNQUFNLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNyRCxHQUFHLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxNQUFNLEtBQUssU0FBUyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUE7b0JBQ3JELEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLG9CQUFvQixDQUFDLENBQUE7b0JBQzVDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtvQkFDVCxNQUFNLENBQUE7Z0JBQ1IsQ0FBQztnQkFFRCxvRUFBb0U7Z0JBQ3BFLEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO2dCQUNwQixHQUFHLENBQUMsU0FBUyxDQUFDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxDQUFBO2dCQUN2RCxHQUFHLENBQUMsU0FBUyxDQUFDLGNBQWMsRUFBRSxjQUFjLENBQUMsQ0FBQTtnQkFFN0MscUNBQXFDO2dCQUNyQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUM7b0JBQzFCLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtvQkFDVCxNQUFNLENBQUE7Z0JBQ1IsQ0FBQztnQkFFRCxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sT0FBTyxDQUFDLENBQUE7Z0JBQ3RCLE1BQU0sQ0FBQTtZQUNSLENBQUM7WUFFRCx5RUFBeUU7WUFDekUscUNBQXFDO1lBQ3JDLHlFQUF5RTtZQUV6RSwwRUFBMEU7WUFDMUUseUNBQXlDO1lBQ3pDLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNsRSxvREFBb0Q7Z0JBQ3BELEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxLQUFLLEtBQUssSUFBSSxHQUFHLENBQUMsTUFBTSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDckQsR0FBRyxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUMsTUFBTSxLQUFLLFNBQVMsR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFBO29CQUNyRCxHQUFHLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxvQkFBb0IsQ0FBQyxDQUFBO29CQUM1QyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUE7b0JBQ1QsTUFBTSxDQUFBO2dCQUNSLENBQUM7Z0JBRUQsa0VBQWtFO2dCQUNsRSx5REFBeUQ7Z0JBQ3pELE1BQU0sU0FBUyxHQUFHLGNBQVcsQ0FDM0IsV0FBUSxDQUNOLHlCQUFpQixFQUNqQixRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxNQUFNLENBQUMsQ0FDaEUsQ0FDRixDQUFBO2dCQUVELHVFQUF1RTtnQkFDdkUsb0VBQW9FO2dCQUNwRSxNQUFNLGlCQUFpQixHQUFHLGVBQVksQ0FBQyx5QkFBaUIsRUFBRSxTQUFTLENBQUMsQ0FBQTtnQkFFcEUsOENBQThDO2dCQUM5QyxFQUFFLENBQUMsQ0FDRCxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSx5QkFBaUIsQ0FBQyxNQUFNLENBQUMsS0FBSyx5QkFBaUI7b0JBQ25FLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssSUFDckMsQ0FBQyxDQUFDLENBQUM7b0JBQ0QsR0FBRyxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUE7b0JBQ3BCLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtvQkFDVCxNQUFNLENBQUE7Z0JBQ1IsQ0FBQztnQkFFRCxrRUFBa0U7Z0JBQ2xFLGFBQWE7Z0JBQ2IsRUFBRSxDQUFDLENBQ0QsaUJBQWlCLEtBQUssWUFBWTtvQkFDbEMsaUJBQWlCLEtBQUsscUJBQ3hCLENBQUMsQ0FBQyxDQUFDO29CQUNELEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO29CQUNwQixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUE7b0JBQ1QsTUFBTSxDQUFBO2dCQUNSLENBQUM7Z0JBRUQsbUVBQW1FO2dCQUNuRSxHQUFHLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQTtnQkFDcEIsTUFBTSxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNO29CQUNoQyxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsR0FBRyxFQUFFLGlCQUFpQixFQUFFO3dCQUM5QyxLQUFLLEVBQUUsS0FBSzt3QkFDWixJQUFJLEVBQUUseUJBQWlCO3dCQUN2QixRQUFRLEVBQUUsUUFBUTtxQkFDbkIsQ0FBQzt5QkFDQyxFQUFFLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQzt5QkFDbEIsRUFBRSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUM7eUJBQ25CLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtnQkFDZCxDQUFDLENBQUMsQ0FBQTtnQkFDRixNQUFNLENBQUE7WUFDUixDQUFDO1lBRUQseUVBQXlFO1lBQ3pFLHdCQUF3QjtZQUN4Qix5RUFBeUU7WUFFekUscUVBQXFFO1lBQ3JFLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEtBQUssdUJBQXVCLENBQUMsQ0FBQyxDQUFDO2dCQUN2RCxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sS0FBSyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7b0JBQy9DLEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO29CQUNwQixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUE7b0JBQ1QsTUFBTSxDQUFBO2dCQUNSLENBQUM7Z0JBQ0QsK0JBQXFCLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQTtnQkFDeEMsTUFBTSxDQUFBO1lBQ1IsQ0FBQztZQUVELHlFQUF5RTtZQUN6RSxnQkFBZ0I7WUFDaEIseUVBQXlFO1lBRXpFLG1FQUFtRTtZQUNuRSxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxLQUFLLGFBQWEsQ0FBQyxDQUFDLENBQUM7Z0JBQzdDLDREQUE0RDtnQkFDNUQsRUFBRSxDQUFDLENBQUMsZ0JBQWdCLEtBQUssYUFBYSxDQUFDLENBQUMsQ0FBQztvQkFDdkMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxRQUFRLEVBQUUsdUJBQXVCLEVBQUUsQ0FBQyxDQUFBO29CQUN6RCxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUE7b0JBQ1QsTUFBTSxDQUFBO2dCQUNSLENBQUM7Z0JBRUQsb0RBQW9EO2dCQUNwRCxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sS0FBSyxLQUFLLElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3JELEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFDLE1BQU0sS0FBSyxTQUFTLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQTtvQkFDckQsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsb0JBQW9CLENBQUMsQ0FBQTtvQkFDNUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFBO29CQUNULE1BQU0sQ0FBQTtnQkFDUixDQUFDO2dCQUVELEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO2dCQUNwQixHQUFHLENBQUMsU0FBUyxDQUFDLGNBQWMsRUFBRSwwQkFBMEIsQ0FBQyxDQUFBO2dCQUV6RCxxQ0FBcUM7Z0JBQ3JDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQztvQkFDMUIsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFBO29CQUNULE1BQU0sQ0FBQTtnQkFDUixDQUFDO2dCQUVELDZCQUE2QjtnQkFDN0IsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLFlBQVksQ0FBQyxDQUFBO2dCQUMzQixNQUFNLENBQUE7WUFDUixDQUFDO1FBQ0gsQ0FBQztRQUVELDhEQUE4RDtRQUM5RCxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxLQUFLLFlBQVksQ0FBQztZQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUUxRCwyRUFBMkU7UUFDM0UsMEJBQTBCO1FBQzFCLDJFQUEyRTtRQUUzRSwyRUFBMkU7UUFDM0UsR0FBRyxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUE7UUFFcEIsMkRBQTJEO1FBQzNELEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQztZQUM3QixHQUFHLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQTtZQUNwQixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUE7WUFDVCxNQUFNLENBQUE7UUFDUixDQUFDO1FBRUQsb0VBQW9FO1FBQ3BFLG9FQUFvRTtRQUNwRSw0Q0FBNEM7UUFDNUMsSUFBSSxNQUFNLENBQUE7UUFDVixJQUFJLE1BQU0sQ0FBQTtRQUNWLElBQUksZ0JBQWdCLENBQUE7UUFDcEIsTUFBTSxjQUFjLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO1FBQ3ZDLElBQUksTUFBTSxDQUFBO1FBRVYsWUFBWSxDQUFDLGtDQUFrQyxDQUFDLENBQUE7UUFFaEQseUVBQXlFO1FBQ3pFLHlFQUF5RTtRQUN6RSw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDO1lBQ0gsd0VBQXdFO1lBQ3hFLDZEQUE2RDtZQUM3RCxNQUFNLFNBQVMsR0FBRyxNQUFNLFlBQVksRUFBRSxDQUFBO1lBRXRDLGlFQUFpRTtZQUNqRSxxRUFBcUU7WUFDckUsd0VBQXdFO1lBQ3hFLHFCQUFxQjtZQUNyQixFQUFFO1lBQ0Ysd0VBQXdFO1lBQ3hFLHlFQUF5RTtZQUN6RSxnRUFBZ0U7WUFDaEUsRUFBRTtZQUNGLHlFQUF5RTtZQUN6RSwyQ0FBMkM7WUFDM0MsTUFBTSxxQkFBcUIsQ0FBQyxNQUFNLENBQ2hDLENBQUMsT0FBTyxFQUFFLFVBQVUsS0FDbEIsT0FBTyxDQUFDLElBQUksQ0FDVixNQUNFLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU07Z0JBQzFCLFVBQVUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUs7b0JBQ3hCLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQzt3QkFBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7b0JBQ3hCLElBQUk7d0JBQUMsT0FBTyxFQUFFLENBQUE7Z0JBQ2hCLENBQUMsQ0FBQyxDQUFBO1lBQ0osQ0FBQyxDQUFDLENBQ0wsRUFDSCxPQUFPLENBQUMsT0FBTyxFQUFFLENBQ2xCLENBQUE7WUFFRCw2REFBNkQ7WUFDN0QsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUMxQixHQUFHLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxlQUFlLENBQUMsQ0FBQTtnQkFDdkMsTUFBTSxTQUFTLENBQUMsR0FBRyxFQUFFLG1DQUFtQyxDQUFDLENBQUE7WUFDM0QsQ0FBQztZQUVELHdFQUF3RTtZQUN4RSxXQUFXO1lBQ1gsRUFBRTtZQUNGLGdEQUFnRDtZQUNoRCx1RUFBdUU7WUFDdkUsd0VBQXdFO1lBQ3hFLGtCQUFrQjtZQUNsQixNQUFNLEdBQUcsT0FBTyxHQUFHLENBQUMsSUFBSSxLQUFLLFFBQVEsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQTtZQUV0RSxvQ0FBb0M7WUFDcEMsRUFBRSxDQUFDLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQztnQkFDakIsTUFBTSxTQUFTLENBQ2IsR0FBRyxFQUNILHVEQUF1RCxDQUN4RCxDQUFBO1lBQ0gsRUFBRSxDQUFDLENBQUMsT0FBTyxNQUFNLEtBQUssUUFBUSxDQUFDO2dCQUM3QixNQUFNLFNBQVMsQ0FDYixHQUFHLEVBQ0gsaURBQWlELE9BQU8sTUFBTSxJQUFJLENBQ25FLENBQUE7WUFDSCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUN4QixNQUFNLFNBQVMsQ0FDYixHQUFHLEVBQ0gsOEZBQThGLENBQy9GLENBQUE7WUFDSCxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7Z0JBQUMsTUFBTSxTQUFTLENBQUMsR0FBRyxFQUFFLDhCQUE4QixDQUFDLENBQUE7WUFFdkUsc0VBQXNFO1lBQ3RFLHNCQUFzQjtZQUN0QixFQUFFLENBQUMsQ0FBQyxPQUFPLE1BQU0sQ0FBQyxTQUFTLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQztnQkFDekMscUVBQXFFO2dCQUNyRSxhQUFhO2dCQUNiLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztvQkFDNUIsTUFBTSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUE7Z0JBQ3pCLENBQUM7Z0JBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ04sNkNBQTZDO29CQUM3QyxJQUFJLENBQUM7d0JBQ0gsTUFBTSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQTtvQkFDakQsQ0FBQztvQkFBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO3dCQUNmLEtBQUssQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO3dCQUN0QixNQUFNLEtBQUssQ0FBQTtvQkFDYixDQUFDO2dCQUNILENBQUM7WUFDSCxDQUFDO1lBRUQsa0RBQWtEO1lBQ2xELEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLElBQUksSUFBSSxJQUFJLE9BQU8sTUFBTSxDQUFDLFNBQVMsS0FBSyxRQUFRLENBQUM7Z0JBQ25FLE1BQU0sU0FBUyxDQUNiLEdBQUcsRUFDSCxxQ0FBcUMsT0FBTyxNQUFNLENBQUMsU0FBUyxJQUFJLENBQ2pFLENBQUE7WUFFSCxxREFBcUQ7WUFDckQsRUFBRSxDQUFDLENBQ0QsTUFBTSxDQUFDLGFBQWEsSUFBSSxJQUFJO2dCQUM1QixPQUFPLE1BQU0sQ0FBQyxhQUFhLEtBQUssUUFDbEMsQ0FBQztnQkFDQyxNQUFNLFNBQVMsQ0FDYixHQUFHLEVBQ0gseUNBQXlDLE9BQU8sTUFBTSxDQUFDLGFBQWEsSUFBSSxDQUN6RSxDQUFBO1lBRUgsTUFBTSxNQUFNLEdBQUcsSUFBSSxnQkFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsc0JBQXNCLENBQUMsQ0FBQTtZQUUvRCx1RUFBdUU7WUFDdkUsa0RBQWtEO1lBQ2xELElBQUksQ0FBQztnQkFDSCxnQkFBZ0IsR0FBRyxlQUFZLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDekMsQ0FBQztZQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ2YsR0FBRyxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUE7Z0JBQ3BCLE1BQU0sS0FBSyxDQUFBO1lBQ2IsQ0FBQztZQUVELFlBQVksQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO1lBRXhDLGdEQUFnRDtZQUNoRCx1Q0FBdUM7WUFDdkMsTUFBTSxnQkFBZ0IsR0FBRyxrQkFBZSxDQUFDLFNBQVMsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO1lBRXJFLHNFQUFzRTtZQUN0RSxtREFBbUQ7WUFDbkQsRUFBRSxDQUFDLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2hDLEdBQUcsQ0FBQyxVQUFVLEdBQUcsR0FBRyxDQUFBO2dCQUNwQixNQUFNLEdBQUcsRUFBRSxNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQTtnQkFDckMsTUFBTSxDQUFBO1lBQ1IsQ0FBQztZQUVELFlBQVksQ0FBQyw2QkFBNkIsQ0FBQyxDQUFBO1lBRTNDLHNFQUFzRTtZQUN0RSxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDO2dCQUN2QixZQUFZLENBQ1YsZUFBWSxDQUFDLGdCQUFnQixDQUFDO3FCQUMzQixPQUFPLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQztxQkFDcEIsSUFBSSxFQUFFLENBQ1YsQ0FBQTtZQUVILE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxTQUFTLEdBQUcsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQTtZQUU1RCxNQUFNLGlCQUFpQixHQUNyQixPQUFPLG1DQUFtQyxLQUFLLFVBQVU7a0JBQ3JELE1BQU0sbUNBQW1DLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQztrQkFDbkQsRUFBRSxDQUFBO1lBQ1IsTUFBTSxHQUFHLE1BQU0saUNBQXVCLENBQ3BDO2dCQUNFLE1BQU07Z0JBQ04sUUFBUTtnQkFDUixTQUFTO2dCQUNULFlBQVk7Z0JBQ1osT0FBTztnQkFDUCxnQkFBZ0I7Z0JBQ2hCLGFBQWE7Z0JBQ2IsVUFBVSxFQUNSLE9BQU8sVUFBVSxLQUFLLFVBQVU7c0JBQzVCLE1BQU0sVUFBVSxDQUFDLEdBQUcsQ0FBQztzQkFDckIsVUFBVTthQUNqQixFQUNELE9BQU87Z0JBQ0wsTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUE7Z0JBQ3ZCLE1BQU0sY0FBYyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLGlCQUFpQixFQUFFLE9BQU8sQ0FBQyxDQUFBO2dCQUNwRSxNQUFNLENBQUMsaUJBQWMsQ0FDbkIsU0FBUyxFQUNULGdCQUFnQixFQUNoQixJQUFJLEVBQ0osY0FBYyxFQUNkLE1BQU0sQ0FBQyxTQUFTLEVBQ2hCLE1BQU0sQ0FBQyxhQUFhLENBQ3JCLENBQUE7WUFDSCxDQUFDLENBQ0YsQ0FBQTtRQUNILENBQUM7UUFBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ2YsdURBQXVEO1lBQ3ZELEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEtBQUssR0FBRyxDQUFDO2dCQUN6QixHQUFHLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsSUFBSSxHQUFHLENBQUE7WUFDMUQsTUFBTSxHQUFHLEVBQUUsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQTtZQUU1QixrREFBa0Q7WUFDbEQsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsS0FBSyxHQUFHLENBQUM7Z0JBQ3pCLHNDQUFzQztnQkFDdEMsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDOUIsQ0FBQztnQkFBUyxDQUFDO1lBQ1Qsd0RBQXdEO1lBQ3hELFlBQVksQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFBO1lBQ2hELDhEQUE4RDtZQUM5RCxFQUFFLENBQUMsQ0FBQyxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztnQkFDMUIsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQTtZQUVoRCxHQUFHLENBQUMsU0FBUyxDQUFDLGNBQWMsRUFBRSxpQ0FBaUMsQ0FBQyxDQUFBO1lBQ2hFLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBO1lBRS9CLFlBQVksQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFBO1lBRS9DLCtEQUErRDtZQUMvRCxFQUFFLENBQUMsQ0FBQyxnQkFBZ0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO2dCQUNqRCxNQUFNLFdBQVcsR0FBRyxlQUFZLENBQUMsZ0JBQWdCLENBQUM7cUJBQy9DLE9BQU8sQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDO3FCQUNwQixJQUFJLEVBQUUsQ0FBQTtnQkFDVCxNQUFNLFVBQVUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFBO2dCQUMvQyxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFBO2dCQUMvQyxNQUFNLEVBQUUsR0FDTixJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLEdBQUcsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFBO2dCQUVuRSxtRUFBbUU7Z0JBQ25FLHNDQUFzQztnQkFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FDVCxHQUFHLEtBQUssQ0FBQyxVQUFVLEtBQUssQ0FBQyxHQUFHLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FDMUMsR0FBRyxVQUFVLFdBQVcsQ0FDekIsSUFDQyxNQUFNLElBQUksSUFBSSxHQUFHLE1BQU0sS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxHQUFHLEVBQ3BELE1BQU0sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLE9BQU8sV0FBVyxFQUFFLENBQ2hELENBQUE7WUFDSCxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUMsQ0FBQTtJQUVEOzs7Ozs7Ozs7O09BVUc7SUFDSCxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDYixzRUFBc0U7UUFDdEUsb0JBQW9CO1FBQ3BCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxPQUFPLENBQUMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBQzlDLHdDQUF3QztZQUN4QyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUE7WUFDYixNQUFNLElBQUksR0FBRyxDQUFDLENBQUE7WUFFZCxvRUFBb0U7WUFDcEUsb0VBQW9FO1lBQ3BFLG9CQUFvQjtZQUNwQixNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUMvQyxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDTix5RUFBeUU7WUFDekUscUVBQXFFO1lBQ3JFLGlCQUFpQjtZQUNqQixNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUE7WUFDYixNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUE7WUFDYixNQUFNLElBQUksR0FBRyxDQUFDLElBQUksWUFBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQTtZQUV4QywrQkFBK0I7WUFDL0IsY0FBYyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsSUFBSTtZQUNqQyxzQ0FBc0M7WUFDdEM7Z0JBQ0UsVUFBVTtZQUNaLENBQUM7WUFDRCwwREFBMEQ7WUFDMUQsS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FDckIsQ0FBQTtRQUNILENBQUM7SUFDSCxDQUFDLENBQUE7QUFDSCxDQUFDOztBQTFoQkQsdURBMGhCQztBQUVEOzs7Ozs7Ozs7OztHQVdHO0FBQ0gsd0JBQXdCLEdBQUc7SUFDekIsR0FBRyxDQUFDLFNBQVMsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNqRCxHQUFHLENBQUMsU0FBUyxDQUFDLCtCQUErQixFQUFFLGlCQUFpQixDQUFDLENBQUE7SUFDakUsR0FBRyxDQUFDLFNBQVMsQ0FDWCw4QkFBOEIsRUFDOUI7UUFDRSxRQUFRO1FBQ1Isa0JBQWtCO1FBQ2xCLHdFQUF3RTtRQUN4RSxrQ0FBa0M7UUFDbEMsUUFBUTtRQUNSLDBDQUEwQztRQUMxQyxlQUFlO1FBQ2YscUVBQXFFO1FBQ3JFLDBCQUEwQjtRQUMxQixjQUFjO1FBQ2QsZ0JBQWdCO0tBQ2pCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUNiLENBQUE7QUFDSCxDQUFDO0FBRUQ7Ozs7Ozs7Ozs7Ozs7R0FhRztBQUNILE1BQU0sc0JBQXNCLEdBQUcsd0NBQXdDLENBQUE7QUFFdkU7Ozs7Ozs7OztHQVNHO0FBQ0gscUJBQXFCLE9BQU87SUFDMUIsTUFBTSxFQUFFLGFBQWEsRUFBRSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUE7SUFFekMsMERBQTBEO0lBQzFELEVBQUUsQ0FBQyxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUM7UUFBQyxNQUFNLENBQUMsSUFBSSxDQUFBO0lBRXRDLE1BQU0sS0FBSyxHQUFHLHNCQUFzQixDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQTtJQUV4RCx5RUFBeUU7SUFDekUscUJBQXFCO0lBQ3JCLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ1QsTUFBTSxTQUFTLENBQ2IsR0FBRyxFQUNILGtFQUFrRSxDQUNuRSxDQUFBO0lBRUgsbUNBQW1DO0lBQ25DLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDakIsQ0FBQyJ9